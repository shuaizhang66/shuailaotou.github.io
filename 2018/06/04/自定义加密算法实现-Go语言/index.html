
<hr />
<p>layout: post
title: â€œè‡ªå®šä¹‰åŠ å¯†ç®—æ³•å®ç°â€“Goè¯­è¨€â€
date: 2018-06-04
description: â€œè‡ªå®šä¹‰åŠ å¯†ç®—æ³•å®ç°â€“Goè¯­è¨€â€
tag: åŠ å¯†ç®—æ³•
keywords: â€œgoâ€
â€”</p>

<div class="highlighter-rouge"><pre class="highlight"><code>package main

import (
	"bytes"
	"fmt"
	"encoding/base64"
)


func main() {


//1232cdab89 ä¸ºè‡ªå®šä¹‰çš„ç§˜é’¥
EncryCode :=Encrypt([]byte("hello world"),[]byte("1232cdab89"))
    fmt.Println(base64.StdEncoding.EncodeToString(EncryCode))

	// è§£å¯†
	var DeCryptCode = Decrypt(EncryCode,[]byte("1232cdab89"))
	//æ‰“å°æ˜æ–‡
	fmt.Println(string(DeCryptCode))

	
}
//origæ˜æ–‡ï¼Œkey å¯†é’¥
func Encrypt(orig []byte,key []byte)[]byte  {
 //åŠ å¯†æ–¹å¼ï¼Œå¯¹å¯†é’¥è¿›è¡ŒåŠ æ³•è¿ç®—
	sum := getAddIteam(key)

	//ç»™æ˜æ–‡è¡¥ç ï¼Œé»˜è®¤æŒ‰8å–æ¨¡
	var pk_code = PKCS8Padding(orig,8)
	
	//è¡¥ç ä¹‹åçš„æ¯ä¸€ä½éƒ½åŠ ä¸Šé€šè¿‡å¯†é’¥ç®—å‡ºçš„sumå€¼
	for k := 0; k &lt; len(pk_code); k++ {
		pk_code[k] = pk_code[k] + byte(sum)

	}
    return pk_code


}

func Decrypt(orig []byte,key []byte)[]byte  {
	sum := getAddIteam(key)

	//è§£å¯†
	for k := 0; k &lt; len(orig); k++ {
		orig[k] = orig[k] - byte(sum)
	}

//å»è¡¥ç 
	var pk_up_code  = PKCS8UnPadding(orig)
	return pk_up_code

	
}

//è¡¥ç ï¼ŒæŒ‰8å–æ¨¡ï¼Œå¯¹8å·®å‡ è¡¥å‡ 
func PKCS8Padding(orig []byte,size int)[]byte  {

	length:=len(orig)
	padding :=  size - length%size
	//å‘byteç±»å‹çš„æ•°ç»„ä¸­æ·»åŠ é‡å¤çš„æ·»åŠ padding
	repeats:= bytes.Repeat([]byte{byte(padding)},padding)
	return append(orig,repeats...)

}
//å»ç 

func PKCS8UnPadding(origData []byte)[]byte {

	length:= len(origData)
	updadding:= int(origData[length - 1])
	return origData[:length - updadding]
	
}
 //åŠ å¯†æ–¹å¼ï¼Œå¯¹å¯†é’¥è¿›è¡ŒåŠ æ³•è¿ç®—

func getAddIteam(key []byte) int  {


	var sum  = 0
	//å®ç°å°†ç§˜é’¥ä¸­çš„æ¯ä¸ªå­—èŠ‚ç›¸åŠ ï¼Œé€šè¿‡sumå®ç°origçš„åŠ å¯†å·¥ä½œ
	for i := 0; i &lt; len(key); i++ {

		sum = sum + int(key[i])

	}
	return sum
}


</code></pre>
</div>
<blockquote>
  <p>å¦‚æœ‰é”™è¯¯æè¿°ï¼Œè¯·è¯„è®ºçº æ­£ï¼Œè°¢è°¢å¤§å®¶ï¼ğŸ³ğŸ³ğŸ³</p>
</blockquote>

